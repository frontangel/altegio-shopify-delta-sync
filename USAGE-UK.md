# –®–≤–∏–¥–∫—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –∫–æ—Ä–æ—Ç–∫–æ –ø–æ—è—Å–Ω—é—î, —è–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó Altegio ‚Üí Shopify —ñ —è–∫ –Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å.

## –í–∏–º–æ–≥–∏
- Node.js 20+
- –î–æ—Å—Ç—É–ø –¥–æ Shopify Admin API (–¥–æ–º–µ–Ω –º–∞–≥–∞–∑–∏–Ω—É —Ç–∞ access token)
- –î–∞–Ω—ñ –∫–æ–º–ø–∞–Ω—ñ—ó/—Å–∫–ª–∞–¥—É Altegio —Ç–∞ —Ç–æ–∫–µ–Ω–∏ (partner + user)

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
1. –°–∫–æ–ø—ñ—é–π—Ç–µ `.env.example` (—è–∫—â–æ —î) –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å `.env` —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É.
2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –∑–º—ñ–Ω–Ω—ñ (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ):
   - `SF_DOMAIN`, `SF_ADMIN_ACCESS_TOKEN`, `SF_API_VERSION`, `SF_CONST_LOCATION_ID`
   - `ALTEGIO_COMPANY_ID`, `ALTEGIO_STORAGE_ID`, `ALTEGIO_TOKEN`, `ALTEGIO_USER_TOKEN`
   - –ù–µ–æ–±–æ–≤ º—è–∑–∫–æ–≤–æ: `PORT`, `WARMUP_ON_START`, `SKU_REFRESH_INTERVAL_MS`, `BASIC_AUTH_USER`, `BASIC_AUTH_PASS`, `IDEMPOTENCY_TTL_MS`, `QUEUE_BACKOFF_BASE_MS`.
3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ: `yarn install` –∞–±–æ `npm install` (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–¥–∏–Ω –º–µ–Ω–µ–¥–∂–µ—Ä).

## –ó–∞–ø—É—Å–∫
- –ü—Ä–æ–¥–∞–∫—à–Ω-–ø–æ–¥—ñ–±–Ω–∏–π: `yarn start` –∞–±–æ `npm start` ‚Äî –∑–∞–ø—É—Å–∫–∞—î Express-—Å–µ—Ä–≤–µ—Ä –Ω–∞ `PORT` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 3000).
- –†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–∫–∏: `yarn start:dev` –∞–±–æ `npm run start:dev` ‚Äî —ñ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º (nodemon).
- –¢–µ—Å—Ç–∏: `yarn test` –∞–±–æ `npm test` ‚Äî –∑–∞–ø—É—Å–∫–∞—î –±–∞–∑–æ–≤—ñ —é–Ω—ñ—Ç-—Ç–µ—Å—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –∫—Ä–æ–∫—ñ–≤ –ø–∞–π–ø–ª–∞–π–Ω–∞ —Ç–∞ —á–µ—Ä–≥–∏ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∏–π runner Node.js).

## –û—Å–Ω–æ–≤–Ω—ñ –µ–Ω–¥–ø–æ—ó–Ω—Ç–∏
- `POST /webhook` ‚Äî –ø—Ä–∏–π–º–∞—î –≤–µ–±—Ö—É–∫–∏ Altegio, —Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∏ —É —á–µ—Ä–≥—É –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤ Shopify.
- `GET /healthz` ‚Äî —Å—Ç–∞–Ω —Å–µ—Ä–≤—ñ—Å—É (`ready`, —Ä–æ–∑–º—ñ—Ä –∫–µ—à—É SKU).
- `GET /sku?sku=ABC-123` ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î `inventoryItemId` —É Shopify –¥–ª—è –ø–µ—Ä–µ–¥–∞–Ω–æ–≥–æ SKU (–ø—ñ–¥ –±–∞–∑–æ–≤–æ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é).
- `GET /db` ‚Äî JSON –¥–∞–º–ø –∫–µ—à—ñ–≤ (–ø—ñ–¥ –±–∞–∑–æ–≤–æ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é).
- `GET /logs` ‚Äî HTML-–ª–æ–≥ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –ø–æ–¥—ñ–π (–ø—ñ–¥ –±–∞–∑–æ–≤–æ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é).
- `POST /sync/all` ‚Äî —Å—Ç–∞–≤–∏—Ç—å —É —á–µ—Ä–≥—É –≤—Å—ñ —Ç–æ–≤–∞—Ä–∏ –∑—ñ —Å–∫–ª–∞–¥—É Altegio –¥–ª—è –ø–æ–≤–Ω–æ—ó —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑–∞–ª–∏—à–∫—ñ–≤ (–ø—ñ–¥ –±–∞–∑–æ–≤–æ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é; –ø–æ–≤–µ—Ä—Ç–∞—î 409, —è–∫—â–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è).

## –†–æ–±–æ—Ç–∞ —á–µ—Ä–≥–∏
- –ü—Ä–æ–¥—É–∫—Ç–∏ —Å—Ç–∞–≤–ª—è—Ç—å—Å—è —É —á–µ—Ä–≥—É (Redis –∞–±–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª `store/pending-queue.json`).
- –ö–æ–∂–Ω—ñ 2 —Å–µ–∫—É–Ω–¥–∏ –æ–±—Ä–æ–±–Ω–∏–∫ –∑–∞–±–∏—Ä–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π `good_id` —ñ –æ–Ω–æ–≤–ª—é—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É Shopify.
- –ü—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–∏–π backoff —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞; —É—Å–ø—ñ—à–Ω—ñ/–ø—Ä–æ–ø—É—â–µ–Ω—ñ –ø–æ–¥—ñ—ó –ª–æ–≥—É—é—Ç—å—Å—è.
- –Ø–∫—â–æ Redis –¥–µ–≥—Ä–∞–¥—É—î, —Å–µ—Ä–≤—ñ—Å –ª–æ–≥—É–≤–∞—Ç–∏–º–µ –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –¥–∏—Å–∫–æ–≤—É —á–µ—Ä–≥—É (`üö® Redis degraded...`), —â–æ –¥–∞—î DevOps —Å–∏–≥–Ω–∞–ª –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É.
- –ü–æ–¥—ñ—ó, —è–∫—ñ –Ω–µ –≤–¥–∞–ª–æ—Å—è –æ–±—Ä–æ–±–∏—Ç–∏ (–Ω–µ–≤—ñ–¥–æ–º–∏–π —Ä–µ—Å—É—Ä—Å —á–∏ –ø–æ–º–∏–ª–∫–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó), –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É `store/dead-letter.json` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è/–ø–æ–≤—Ç–æ—Ä–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏.

## –¢–∏–ø–æ–≤–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π
1. –ó–∞–ø—É—Å–∫–∞—î—Ç–µ —Å–µ—Ä–≤—ñ—Å (–¥–∏–≤. —Ä–æ–∑–¥—ñ–ª ¬´–ó–∞–ø—É—Å–∫¬ª).
2. –ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç–µ –≤–µ–±—Ö—É–∫–∏ –≤ Altegio, —â–æ–± –≤–æ–Ω–∏ –Ω–∞–¥—Å–∏–ª–∞–ª–∏ –ø–æ–¥—ñ—ó –Ω–∞ `POST /webhook` –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
3. –ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–µ `GET /healthz` —Ç–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É `GET /logs` (–∑ –±–∞–∑–æ–≤–æ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é, —è–∫—â–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é —Å—Ç–∞–Ω—É.
4. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å SKU ‚Üí Shopify —á–µ—Ä–µ–∑ `GET /sku?sku=...`.
